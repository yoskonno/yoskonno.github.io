{"componentChunkName":"component---src-templates-post-js","path":"/2019/03/07/process-s3-file-using-stream/","result":{"data":{"wordpressPost":{"id":"d69cc4f9-c4a9-53cc-a66f-3519c07ed0d0","title":"AWS CLIで標準入出力でS3オブジェクトを操作する方法","excerpt":"<p>標準入力からアップロード 標準出力へダウンロード ご覧の通り、 -を引数として渡すとそれぞれ標準入出力が使われます。既に周知かと思いますが、僕は知りませんでした。普段からちょっとしたファイルの操作をする時に、いちいち物理 [&hellip;]</p>\n","slug":"process-s3-file-using-stream","content":"\n<h3><strong>標準入力からアップロード</strong></h3>\n\n\n<pre class=\"brush: plain; title: ; notranslate\" title=\"\">\n$ echo 'hogehoge' | aws s3 cp - s3://&lt;bucket-name&gt;/&lt;object-key&gt;\n</pre>\n\n\n<h3><strong>標準出力へダウンロード</strong></h3>\n\n\n<pre class=\"brush: plain; title: ; notranslate\" title=\"\">\n$ aws s3 cp s3://&lt;bucket-name&gt;/&lt;object-key&gt; -\n</pre>\n\n\n<p>ご覧の通り、 <code>-</code>を引数として渡すとそれぞれ標準入出力が使われます。既に周知かと思いますが、僕は知りませんでした。普段からちょっとしたファイルの操作をする時に、いちいち物理ファイルを経由していました。なので備忘録として残しておきます。</p>\n\n\n\n<p><code>s3 cp</code>のヘルプを見ると一番最後に書いてあります（分かりづらい）:</p>\n\n\n<pre class=\"brush: plain; title: ; notranslate\" title=\"\">\nUploading a local file stream to S3\n\n...\n\nThe following cp command uploads a  local  file  stream  from  standard\ninput to a specified bucket and key:\n\n   aws s3 cp - s3://mybucket/stream.txt\n\nDownloading an S3 object as a local file stream\n\n...\n\nThe following cp command downloads an S3 object locally as a stream  to\nstandard  output.\n\n   aws s3 cp s3://mybucket/stream.txt -\n</pre>\n\n\n<p>因みに、PowerShellで実行するとCRLFのエンコーディングが変更されたり、またはそれ自体が追加される事があるらしいです。また、ダウンロード時は <code>--recursive</code>による、特定キー以下の再帰DLはサポートされないみたい（当たり前だが）なので、いずれも要注意。</p>\n","dateObject":"2019-03-07T03:00:42.000Z","date":"March 07, 2019","categories":[{"name":"Uncategorized","slug":"uncategorized"}],"tags":null,"author":{"name":"issei_m","slug":"issei"},"featured_media":{"media_details":{"sizes":{"large":null,"medium_large":null}},"source_url":"https://stg-engineering-wp.mobalab.net/wp-content/uploads/2019/03/amazon-s3.png"},"wordpress_id":675}},"pageContext":{"id":"d69cc4f9-c4a9-53cc-a66f-3519c07ed0d0","nextPath":"/2019/03/06/allocate-secure-env-in-ssm-parameter-to-ecs-task-definition/","nextTitle":"ECSの機能でSSMのParameter Storeに格納した機密情報をTaskDefinitionに埋め込む","prevPath":"/2019/03/08/laravelのテンプレートでのinclude-yield-sectionの違い/","prevTitle":"Laravelのテンプレートbladeでの@include @yield @sectionの違い"}}}