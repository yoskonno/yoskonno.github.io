{"componentChunkName":"component---src-templates-post-js","path":"/2019/05/16/workaround-for-virtualbox-installation-failure-on-mac/","result":{"data":{"wordpressPost":{"id":"bbffe9f4-3358-56e8-ae59-c554a3bdea19","title":"macOSでVirtualBoxがインストールできない時の対処法","excerpt":"<p>ここ最近プロジェクトではほぼDockerを使うようになり、Vagrantはあまり使わなくなりました。それに伴い、VirtualBoxの使用頻度も3〜4年くらい前に比べると格段と減った気がします。 そんなある日、とあるプロ [&hellip;]</p>\n","slug":"workaround-for-virtualbox-installation-failure-on-mac","content":"\n<p>ここ最近プロジェクトではほぼDockerを使うようになり、Vagrantはあまり使わなくなりました。それに伴い、VirtualBoxの使用頻度も3〜4年くらい前に比べると格段と減った気がします。</p>\n\n\n\n<p>そんなある日、とあるプロジェクトでVagrantが必要になったので、それに併せて古くなっていたVirtualBoxをアップグレードしようとしたら、macOSのセキュリティ機能により一筋縄では行かなかったので対処法を共有します。（アイキャッチ参照）</p>\n\n\n\n<p>例によって、解決策だけみたい人は: <a href=\"#その後対処法を発見\">その後対処法を発見</a></p>\n\n\n\n<h2 id=\"前提\"><a href=\"https://hackmd.io/jx48xh8rS5GCt-3Wtf4YiA?view#%E5%89%8D%E6%8F%90\"></a>前提</h2>\n\n\n\n<p>手元の環境: macOS Mojave Version 10.14.5</p>\n\n\n\n<p>さて、今回、最初にインストールしようとしたのはバージョン6.0.8でした。元のバージョンは5.2.14とかだったと思います。<br>これが失敗した為、5.2.28も試してみましたが、同様のエラーが出てしまった為、解決策を調べる事に。</p>\n\n\n\n<h2 id=\"よくやるアプリの承認はできず・・・\"><a href=\"https://hackmd.io/jx48xh8rS5GCt-3Wtf4YiA?view#%E3%82%88%E3%81%8F%E3%82%84%E3%82%8B%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E6%89%BF%E8%AA%8D%E3%81%AF%E3%81%A7%E3%81%8D%E3%81%9A%E3%83%BB%E3%83%BB%E3%83%BB\"></a>よくやるアプリの承認はできず・・・</h2>\n\n\n\n<p>いつからだかにmacOSに搭載されたGatekeeperと言うセキュリティ機能による物だとは予想していましたが、少し調べた感じ、実際に大抵の記事でそれについて触れていました:</p>\n\n\n\n<ul><li class=\"\"><a href=\"http://osxdaily.com/2018/12/31/install-run-virtualbox-macos-install-kernel-fails/\" target=\"_blank\" rel=\"noreferrer noopener\">How to Install VirtualBox in MacOS Mojave if Installation Fails or Shows Kernel Driver Errors</a></li><li class=\"\"><a href=\"https://medium.com/@DMeechan/fixing-the-installation-failed-virtualbox-error-on-mac-high-sierra-7c421362b5b5\" target=\"_blank\" rel=\"noreferrer noopener\">Fixing ‘The Installation Failed’ VirtualBox Error on Mac High Sierra</a></li></ul>\n\n\n\n<p>いずれの場合も、 “System Preferences -&gt; Security &amp; Privacy -&gt; General” の画面に表示されている「<em>System software from developer “Oracle America, Inc.” was blocked from loading.</em>」と、その横の “Allow” ボタンを押す事で解決となっており、同じ様な手順を他のアプリケーションのインストール時に踏んだ方も多いかと思います。<br>（僕の場合だとKarabiner-Elementsのインストールの時にやったと思います）</p>\n\n\n\n<p>しかし、今回はそもそもAllowボタンを含め、承認の為の文言自体が表示されておらず、できませんでした。<br>後者の記事では、その場合の対処法として <code>sudo spctl —master-disable</code> を実行する事でGatekeeperの制限を弱め（詳細は記事参照）、無理やりインストールすると言う内容でしたが、僕の環境ではそれでもインストール出来ませんでした。</p>\n\n\n\n<h2 id=\"その後対処法を発見\"><a href=\"https://hackmd.io/jx48xh8rS5GCt-3Wtf4YiA?view#%E3%81%9D%E3%81%AE%E5%BE%8C%E5%AF%BE%E5%87%A6%E6%B3%95%E3%82%92%E7%99%BA%E8%A6%8B\"></a>その後対処法を発見</h2>\n\n\n\n<p>Twitterで検索した所、あるStackOverflowを見つけ、まさにこれで解決する事ができました。</p>\n\n\n\n<p><a href=\"https://stackoverflow.com/questions/55004803/install-virtualbox-6-on-mac-10-14-mojave-failed-with-kernel-install-error\" target=\"_blank\" rel=\"noreferrer noopener\">Install Virtualbox 6 on Mac 10.14 Mojave failed with kernel install error</a></p>\n\n\n\n<p>内容としては、 <code>spctl kext-consent</code> コマンドでOracleのDevelopper IDを直接承認すると言う物です。<br>OracleのIDは <code>VB5E2TV963</code> なので、実行するコマンドは</p>\n\n\n<pre class=\"brush: plain; title: ; notranslate\" title=\"\">\n$ spctl kext-consent add VB5E2TV963\n</pre>\n\n\n<p>と言う事になります。ただし、このコマンドはRecovery modeでmacOSを起動している時しか実行できないので、OSをShutdownした後 <code>Command (⌘) + R</code> を押したまま起動してRecovery modeに入り、UtilitiesからTerminalを起動して実行する必要があります。</p>\n\n\n\n<p>一旦追加した後は、以下のコマンドで確認が可能です:</p>\n\n\n<pre class=\"brush: plain; title: ; notranslate\" title=\"\">\n$ sudo spctl kext-consent list\nAllowed Team Identifiers:\nVB5E2TV963\n</pre>\n\n\n<p>確認ができたらOSをRestartしましょう。</p>\n\n\n\n<p>その後、VirtualBoxをインストールすると無事に成功しました。</p>\n\n\n\n<figure class=\"wp-block-image\"><img src=\"https://i0.wp.com/engineering.mobalab.net/wp-content/uploads/2019/05/Screen-Shot-2019-05-16-at-11.09.59.png?fit=680%2C481&amp;ssl=1\" alt=\"\" class=\"wp-image-892\" srcset=\"https://i2.wp.com/stg-engineering-wp.mobalab.net/wp-content/uploads/2019/05/Screen-Shot-2019-05-16-at-11.09.59.png?w=1258&amp;ssl=1 1258w, https://i2.wp.com/stg-engineering-wp.mobalab.net/wp-content/uploads/2019/05/Screen-Shot-2019-05-16-at-11.09.59.png?resize=300%2C212&amp;ssl=1 300w, https://i2.wp.com/stg-engineering-wp.mobalab.net/wp-content/uploads/2019/05/Screen-Shot-2019-05-16-at-11.09.59.png?resize=768%2C543&amp;ssl=1 768w, https://i2.wp.com/stg-engineering-wp.mobalab.net/wp-content/uploads/2019/05/Screen-Shot-2019-05-16-at-11.09.59.png?resize=1024%2C724&amp;ssl=1 1024w\" sizes=\"(max-width: 1200px) 100vw, 1200px\" /></figure>\n\n\n\n<p>ちなみに、OracleのDeveloper IDはVirtualBoxのインストーラーから確認可能です:</p>\n\n\n\n<figure class=\"wp-block-image\"><img src=\"https://i1.wp.com/stg-engineering-wp.mobalab.net/wp-content/uploads/2019/05/Screen-Shot-2019-05-16-at-17.12.42.png?w=1200&#038;ssl=1\" alt=\"\" class=\"wp-image-893\" srcset=\"https://i1.wp.com/stg-engineering-wp.mobalab.net/wp-content/uploads/2019/05/Screen-Shot-2019-05-16-at-17.12.42.png?w=627&amp;ssl=1 627w, https://i1.wp.com/stg-engineering-wp.mobalab.net/wp-content/uploads/2019/05/Screen-Shot-2019-05-16-at-17.12.42.png?resize=300%2C213&amp;ssl=1 300w\" sizes=\"(max-width: 627px) 100vw, 627px\" data-recalc-dims=\"1\" /><figcaption>右上の「鍵」アイコンから確認可能</figcaption></figure>\n\n\n\n<h2 id=\"終わりに\"><a href=\"https://hackmd.io/jx48xh8rS5GCt-3Wtf4YiA?view#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\"></a>終わりに</h2>\n\n\n\n<p><code>spctl kext-consent add</code>&nbsp;コマンドですが、Usageを見ると「無条件（ユーザーの承認無しに）にkextをロードする事を許可する」そうなので、可能であればインストール後に削除したほうが良いかもしれません。（その場合もRecovery modeに入る必要があります）</p>\n","dateObject":"2019-05-16T08:19:23.000Z","date":"May 16, 2019","categories":[{"name":"Uncategorized","slug":"uncategorized"}],"tags":[{"name":"gatekeeper","slug":"gatekeeper"},{"name":"kext","slug":"kext"},{"name":"macos","slug":"macos"},{"name":"vagrant","slug":"vagrant"},{"name":"virtualbox","slug":"virtualbox"},{"name":"workaround","slug":"workaround"}],"author":{"name":"issei_m","slug":"issei"},"featured_media":{"media_details":{"sizes":{"large":{"source_url":"https://i2.wp.com/stg-engineering-wp.mobalab.net/wp-content/uploads/2019/05/Screen-Shot-2019-05-16-at-10.53.58.png?fit=1024%2C724&ssl=1","height":724,"width":1024},"medium_large":{"source_url":"https://i2.wp.com/stg-engineering-wp.mobalab.net/wp-content/uploads/2019/05/Screen-Shot-2019-05-16-at-10.53.58.png?fit=768%2C543&ssl=1","height":543,"width":768}}},"source_url":"https://stg-engineering-wp.mobalab.net/wp-content/uploads/2019/05/Screen-Shot-2019-05-16-at-10.53.58.png"},"wordpress_id":889}},"pageContext":{"id":"bbffe9f4-3358-56e8-ae59-c554a3bdea19","nextPath":"/2019/05/10/python-3-6-の環境を構築してvisual-studio-code-でコーディングする/","nextTitle":"Python 3.6 の環境を構築してVisual Studio Code でコーディングする","prevPath":"/2019/05/20/install-postfix-on-ubuntu-by-ansible/","prevTitle":"Ansible で Ubuntu に postfix をインストール"}}}