{"componentChunkName":"component---src-templates-post-js","path":"/2019/05/20/install-postfix-on-ubuntu-by-ansible/","result":{"data":{"wordpressPost":{"id":"f12500df-39b9-5549-a91d-f97db034173e","title":"Ansible で Ubuntu に postfix をインストール","excerpt":"<p>やりたいことはタイトル通りです。 「え？aptモジュール使えば良いだけでしょ。」 と思うかもしれませんが、それだけだと上手くいかないのです。 問題点 普通に aptコマンドで postfix パッケージをインストールして [&hellip;]</p>\n","slug":"install-postfix-on-ubuntu-by-ansible","content":"\n<p>やりたいことはタイトル通りです。</p>\n\n\n\n<p>「え？<code>apt</code>モジュール使えば良いだけでしょ。」</p>\n\n\n\n<p>と思うかもしれませんが、それだけだと上手くいかないのです。</p>\n\n\n\n<h2>問題点</h2>\n\n\n\n<p>普通に <code>apt</code>コマンドで <code>postfix</code> パッケージをインストールしてみると分かるのですが、インストール時に設定項目の入力を求められます。詳しくは <code>debconf</code>で検索してみて下さい。</p>\n\n\n\n<h2>解決方法</h2>\n\n\n\n<p>Ansible には <code>debconf</code>というモジュールもあるので、今回はそちらを使います。</p>\n\n\n\n<p>具体的には、以下のように記述します。</p>\n\n\n<pre class=\"brush: plain; title: ; notranslate\" title=\"\">\n- name: configure postfix using debconf\n  debconf:\n    name: postfix\n    question: &quot;{{ item.question }}&quot;\n    value: &quot;{{ item.value }}&quot;\n    vtype: &quot;{{ item.vtype }}&quot;\n  with_items:\n    - { question: postfix/main_mailer_type, value: &quot;Satellite system&quot;, vtype: select }\n    - { question: postfix/mailname, value: &quot;host.example.com&quot;, vtype: string }\n    - { question: postfix/relayhost, value: &quot;mail.example.com&quot;, vtype: string }\n</pre>\n\n\n<p>質問に対する回答（ホスト名等）は適宜変更して下さい。</p>\n\n\n\n<p>詳細は、以下のドキュメントをご参照下さい。</p>\n\n\n\n<p><a href=\"https://docs.ansible.com/ansible/latest/modules/debconf_module.html#notes\">debconf – Configure a .deb package — Ansible Documentation</a></p>\n\n\n\n<h2>その他</h2>\n\n\n\n<p>ライトな Ubuntu ユーザーなので、パッケージインストール時に色々設定できるのは debconf という仕組みによって実現されていると初めて知りました。</p>\n\n\n\n<p>ちなみに、Red Hat 系の場合、RPM パッケージのインストールは non-interactive （ユーザーの入力無し）であることが慣例となっているので、こういう問題は通常はありません。</p>\n","dateObject":"2019-05-20T04:31:36.000Z","date":"May 20, 2019","categories":[{"name":"Uncategorized","slug":"uncategorized"}],"tags":[{"name":"Ansible","slug":"ansible"},{"name":"apt","slug":"apt"},{"name":"debconf","slug":"debconf"},{"name":"Ubuntu","slug":"ubuntu"}],"author":{"name":"中の人（管理者）","slug":"engineering_8qmk0b"},"featured_media":{"media_details":{"sizes":{"large":{"source_url":"https://i1.wp.com/stg-engineering-wp.mobalab.net/wp-content/uploads/2019/05/command-97893_1280.png?fit=1024%2C886&ssl=1","height":886,"width":1024},"medium_large":{"source_url":"https://i1.wp.com/stg-engineering-wp.mobalab.net/wp-content/uploads/2019/05/command-97893_1280.png?fit=768%2C665&ssl=1","height":665,"width":768}}},"source_url":"https://stg-engineering-wp.mobalab.net/wp-content/uploads/2019/05/command-97893_1280.png"},"wordpress_id":883}},"pageContext":{"id":"f12500df-39b9-5549-a91d-f97db034173e","nextPath":"/2019/05/16/workaround-for-virtualbox-installation-failure-on-mac/","nextTitle":"macOSでVirtualBoxがインストールできない時の対処法","prevPath":"/2019/05/31/validate-checksum-with-remote-file-using-md5sum/","prevTitle":"（小ネタ）md5sumを使ってリモートにあるファイルとのチェックサムを検証するワンライナー"}}}