{"componentChunkName":"component---src-templates-post-js","path":"/2018/12/07/phpã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª-knapsack-ã‚’ä½¿ã£ã¦ã¿ã‚‹/","result":{"data":{"wordpressPost":{"id":"ee871b3f-1343-5d0a-af23-804053afba64","title":"PHPã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª Knapsack ã‚’ä½¿ã£ã¦ã¿ã‚‹","excerpt":"<p>ä»Šæ—¥ã¯åƒ•ãŒæ™®æ®µä¸­è¦æ¨¡ä»¥ä¸Šã®PJã§ä½¿ã£ã¦ã„ã‚‹ã€PHPã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒªÂ KnapsackÂ ã®ç´¹ä»‹ã‚’ã—ã¾ã™ã€‚ ç‰¹å¾´ Knapsackã®ä¸»ãªç‰¹å¾´ã¯ã€ ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ“ä½œç”¨ã®é«˜éšé–¢æ•°ãŒè±Šå¯Œ ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ« å…¨ã¦ãŒé…å»¶è©•ä¾¡ i [&hellip;]</p>\n","slug":"php%e3%81%ae%e3%82%b3%e3%83%ac%e3%82%af%e3%82%b7%e3%83%a7%e3%83%b3%e3%83%a9%e3%82%a4%e3%83%96%e3%83%a9%e3%83%aa-knapsack-%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%a6%e3%81%bf%e3%82%8b","content":"<p class=\"part\" data-startline=\"3\" data-endline=\"3\">ä»Šæ—¥ã¯åƒ•ãŒæ™®æ®µä¸­è¦æ¨¡ä»¥ä¸Šã®PJã§ä½¿ã£ã¦ã„ã‚‹ã€PHPã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒªÂ <a href=\"https://github.com/DusanKasan/Knapsack\" target=\"_blank\" rel=\"noopener\">Knapsack</a>Â ã®ç´¹ä»‹ã‚’ã—ã¾ã™ã€‚</p>\n<h2 id=\"ç‰¹å¾´\" class=\"part\" data-startline=\"5\" data-endline=\"5\">ç‰¹å¾´</h2>\n<p class=\"part\" data-startline=\"7\" data-endline=\"7\">Knapsackã®ä¸»ãªç‰¹å¾´ã¯ã€</p>\n<ul class=\"part\" data-startline=\"9\" data-endline=\"13\">\n<li class=\"\" data-startline=\"9\" data-endline=\"9\">ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ“ä½œç”¨ã®é«˜éšé–¢æ•°ãŒè±Šå¯Œ</li>\n<li class=\"\" data-startline=\"10\" data-endline=\"10\">ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«</li>\n<li class=\"\" data-startline=\"11\" data-endline=\"11\">å…¨ã¦ãŒé…å»¶è©•ä¾¡</li>\n<li class=\"\" data-startline=\"12\" data-endline=\"13\">iterableã€ã¾ãŸã¯ã“ã‚Œã‚’è¿”ã™callableã¯å…¨ã¦å—ã‘å…¥ã‚Œå¯èƒ½</li>\n</ul>\n<p class=\"part\" data-startline=\"14\" data-endline=\"15\">ã®2ç‚¹ã ã¨æ€ã„ã¾ã™ã€‚<br />\nä»–ã«ã‚‚äº›ç´°ãªäº‹ã§ã™ãŒã€ä¸»è¦ãªæ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¯å…¨ã¦Traitã§æä¾›ã•ã‚Œã¦ã„ã¦ã€æ›´ã«å®Ÿè£…ã®å®Ÿæ…‹è‡ªä½“ã¯é–¢æ•°ã¨ã—ã¦æä¾›ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ä½¿ã„ãŸã„æ©Ÿèƒ½ã ã‘ã‚’åˆ‡ã‚Šå‡ºã—ã¦è‡ªåˆ†ã®ã‚¯ãƒ©ã‚¹ã‚„ãƒ­ã‚¸ãƒƒã‚¯ã«çµ„ã¿è¾¼ã‚ã‚‹ç‚¹ã¨è¨€ã£ãŸç‚¹ãŒé¢ç™½ã„ã§ã™ã€‚</p>\n<p class=\"part\" data-startline=\"17\" data-endline=\"17\">ã•ã¦ã€ä¸Šè¨˜ã«æŒ™ã’ãŸ4ã¤ã®ç‰¹å¾´ã«ã¤ã„ã¦ã€æ˜¨ä»Šã®é–‹ç™ºã‚·ãƒ¼ãƒ³ã«ãŠã„ã¦ã¯ä»Šæ›´ç‰¹ç­†ã™ã¹ãäº‹ã§ã¯ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€1ã¤1ã¤ç´¹ä»‹ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚</p>\n<h2 id=\"ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ“ä½œç”¨ã®é«˜éšé–¢æ•°ãŒè±Šå¯Œ\" class=\"part\" data-startline=\"19\" data-endline=\"19\">ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ“ä½œç”¨ã®é«˜éšé–¢æ•°ãŒè±Šå¯Œ</h2>\n<p class=\"part\" data-startline=\"21\" data-endline=\"22\">Knapsackã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€é€šå¸¸ã§ã‚ã‚Œã°Â <code>\\DusanKasan\\Knapsack\\Collection</code>Â ã‚¯ãƒ©ã‚¹ã‚’ä½¿ã„ã¾ã™ã€‚<br />\nä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‹ã€<code>::from()</code>Â ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚½ãƒ¼ã‚¹ã¨ãªã‚‹iterableï¼ˆã‹iterableã‚’è¿”ã™callableï¼‰ãªå€¤ã‚’å…¥ã‚Œã‚‹äº‹ã§ä½¿ç”¨ãŒå¯èƒ½ã§ã™ã€‚</p>\n<pre class=\"part\" data-startline=\"24\" data-endline=\"30\"><code class=\"php hljs\">$collectionA = <span class=\"hljs-keyword\">new</span> DusanKasan\\Knapsack\\Collection(range(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">100</span>));\n$collectionB = DusanKasan\\Knapsack\\Collection::from(range(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">100</span>)); <span class=\"hljs-comment\">// åŒã˜</span>\n\n<span class=\"hljs-comment\">// å®Ÿã¯ range ã¨è¨€ã†ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚å­˜åœ¨ã™ã‚‹</span>\n$collectionC = DusanKasan\\Knapsack\\Collection::range(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">100</span>); <span class=\"hljs-comment\">// ã“ã‚Œã‚‚ğŸ‘†2ã¤ã¨åŒã˜</span>\n</code></pre>\n<p class=\"part\" data-startline=\"32\" data-endline=\"33\">ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ–ã—ãŸå¾Œã¯ã€<code>map()</code>Â ã‚„Â <code>filter()</code>Â ãªã©ã®é«˜éšé–¢æ•°ï¼ˆãƒ¡ã‚½ãƒƒãƒ‰ï¼‰ã‚’ä½¿ã£ã¦ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®è¦ç´ ã«å¯¾ã—ã¦é–¢æ•°ã‚’é©ç”¨ã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚<br />\nã“ã‚Œã‚‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯é–¢æ•°ã‚’é©ç”¨å¾Œã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿”ã™ã®ã§ã€ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ãŒå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚</p>\n<pre class=\"part\" data-startline=\"35\" data-endline=\"45\"><code class=\"php hljs\">$collection = DusanKasan\\Knapsack\\Collection::range(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">100</span>);\n\n<span class=\"hljs-comment\">// 0,4,10,24,40,64,90,C4,100,144,190,1E4,240,2A4,310,384,400,484,510,5A4,640,6E4,790,844,900,9C4,A90,B64,C40,D24,E10,F04,1000,1104,1210,1324,1440,1564,1690,17C4,1900,1A44,1B90,1CE4,1E40,1FA4,2110,2284,2400,2584,2710</span>\n<span class=\"hljs-keyword\">echo</span> $collection\n    -&gt;map(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">($v)</span> </span>{ <span class=\"hljs-keyword\">return</span> pow($v, <span class=\"hljs-number\">2</span>); }) <span class=\"hljs-comment\">// å€¤ã‚’2ä¹—</span>\n    -&gt;filter(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">($v)</span> </span>{ <span class=\"hljs-keyword\">return</span> $v % <span class=\"hljs-number\">2</span> === <span class=\"hljs-number\">0</span>; }) <span class=\"hljs-comment\">// å¥‡æ•°ã‚’é™¤å¤–</span>\n    -&gt;map(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">($v)</span> </span>{ <span class=\"hljs-keyword\">return</span> dechex($v); }) <span class=\"hljs-comment\">// æ•°å€¤ã‚’16é€²æ•°ã«</span>\n    -&gt;map(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">(string $v)</span> </span>{ <span class=\"hljs-keyword\">return</span> strtoupper($v); }) <span class=\"hljs-comment\">// è‹±å­—ã‚’å¤§æ–‡å­—ã«</span>\n    -&gt;reduce(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">($acc, string $v)</span> </span>{ <span class=\"hljs-keyword\">return</span> $acc . ($acc === <span class=\"hljs-string\">''</span> ? <span class=\"hljs-string\">''</span> : <span class=\"hljs-string\">','</span>) . $v; }, <span class=\"hljs-string\">''</span>); <span class=\"hljs-comment\">// ,åŒºåˆ‡ã‚Šã§é€£çµ</span>\n</code></pre>\n<p class=\"part\" data-startline=\"47\" data-endline=\"47\">é…åˆ—ã«åœ°é“ã«Â <code>array_map</code>,Â <code>array_filter</code>Â ã‚’ãƒã‚¹ãƒˆã—ã¦ã„ãã‚ˆã‚Šå¯èª­æ€§ãŒé«˜ã„ã§ã™ã­ã€‚</p>\n<p class=\"part\" data-startline=\"49\" data-endline=\"49\">ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã«ã¤ã„ã¦ã¯å¤§æŠµã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆä¾‹ãˆã°doctrine/collectionsã¨ã‹ï¼‰ã«ã‚‚å‚™ã‚ã£ã¦ã„ã‚‹æ©Ÿèƒ½ãªã®ã§ç‰¹æ®µçã—ãã¯ãªã„ã§ã™ãŒã€Knapsackã¯é«˜éšé–¢æ•°ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è±Šå¯Œã«å‚™ãˆã¦ã„ã¾ã™ã€‚</p>\n<p class=\"part\" data-startline=\"51\" data-endline=\"52\"><a href=\"http://dusankasan.github.io/Knapsack/\" target=\"_blank\" rel=\"noopener\">å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>ã«å…¨ã¦ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã™ãŒã€ä¸Šã§ä½¿ã£ãŸÂ <code>map()</code>,Â <code>filter()</code>,Â <code>reduce()</code>Â ã¯ã‚‚ã¡ã‚ã‚“ã€Â <code>zip()</code>,Â <code>groupBy()</code>,Â <code>flattern()</code>Â ç­‰ãŒå…¨éƒ¨ã§86ç¨®é¡ã‚‚ã‚ã‚Šã¾ã™ã€‚<br />\nScalaã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¸¦ã«å¤šæ©Ÿèƒ½ã§ã™ã­ã€‚</p>\n<p class=\"part\" data-startline=\"54\" data-endline=\"54\">ã¾ãŸã€<code>reduce()</code>Â ç­‰ã®ç•³è¾¼ã¿å‡¦ç†ç³»ä»¥å¤–ã¯é–¢æ•°ã‚’é©ç”¨å¾Œã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿”ã™ã®ã§ã€å…¨ã¦ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ãŒå¯èƒ½ã¨ãªã£ã¦ã„ã¾ã™ã€‚</p>\n<h2 id=\"ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«\" class=\"part\" data-startline=\"56\" data-endline=\"56\">ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«</h2>\n<p class=\"part\" data-startline=\"58\" data-endline=\"59\">Knapsackã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ã§ã™ã€‚å…ˆç¨‹ã€ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«å­˜åœ¨ã™ã‚‹å¤šæ•°ã®é«˜éšé–¢æ•°ã¯ã»ã¼ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ãŒå¯èƒ½ã¨ç´¹ä»‹ã—ã¾ã—ãŸãŒã€å®Ÿã¯ã“ã‚Œã‚‰ã¯å…¨ã¦ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ã¨ãªã£ã¦ã„ã¾ã™ã€‚<br />\nã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹è‡ªèº«ãŒä¿æŒã—ã¦ã„ã‚‹å€¤ã«é–¢æ•°ã‚’é©ç”¨ã™ã‚‹ä»£ã‚ã‚Šã«ã€é–¢æ•°ã‚’é©ç”¨ã—ãŸå€¤ã«ã‚ˆã‚Šæ–°ã—ãã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç”Ÿæˆã—ã€è¿”ã—ã¾ã™ã€‚</p>\n<pre class=\"part\" data-startline=\"61\" data-endline=\"69\"><code class=\"php hljs\">$collection = DusanKasan\\Knapsack\\Collection::range(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">100</span>);\n$squared = $collection-&gt;map(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">($v)</span> </span>{ <span class=\"hljs-keyword\">return</span> pow($v, <span class=\"hljs-number\">2</span>); }); <span class=\"hljs-comment\">// å€¤ã‚’2ä¹—</span>\n$onlyEven = $squared-&gt;filter(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">($v)</span> </span>{ <span class=\"hljs-keyword\">return</span> $v % <span class=\"hljs-number\">2</span> === <span class=\"hljs-number\">0</span>; }); <span class=\"hljs-comment\">// å¥‡æ•°ã‚’é™¤å¤–</span>\n$hexed = $onlyEven-&gt;map(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">($v)</span> </span>{ <span class=\"hljs-keyword\">return</span> dechex($v); }); <span class=\"hljs-comment\">// æ•°å€¤ã‚’16é€²æ•°ã«</span>\n\n<span class=\"hljs-comment\">// 100, 10000, 10000, \"2710\"</span>\nvar_dump($collection-&gt;last(), $squared-&gt;last(), $onlyEven-&gt;last(), $hexed-&gt;last());\n</code></pre>\n<p class=\"part\" data-startline=\"71\" data-endline=\"72\">ã“ã®ã‚ˆã†ã«éƒ½åº¦çµæœã‚’åˆ¥ã®å¤‰æ•°ã«ãƒã‚¤ãƒ³ãƒ‰ã—ã¦ã¿ã‚‹ã¨ã€1ã¤å‰ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®å€¤ãŒè¨ˆç®—ã®å½±éŸ¿ã‚’å—ã‘ã¦ã„ãªã„äº‹ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚<br />\nã“ã‚Œã«ã‚ˆã‚Šã€ã©ã®ã‚ˆã†ãªé–¢æ•°ã®å¼•æ•°ã«ã‚‚å®‰å¿ƒã—ã¦ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ¸¡ã™äº‹ãŒã§ãã¾ã™ã€‚</p>\n<h2 id=\"å…¨ã¦ãŒé…å»¶è©•ä¾¡\" class=\"part\" data-startline=\"74\" data-endline=\"74\">å…¨ã¦ãŒé…å»¶è©•ä¾¡</h2>\n<p class=\"part\" data-startline=\"76\" data-endline=\"77\">Knapsackã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯é©ç”¨ã—ãŸé–¢æ•°ã¯å…¨ã¦ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚ã¾ã§é…å»¶ã—ã¾ã™ã€‚<br />\nä¾‹ãˆã°ã€æœ€åˆã®ä¾‹ã‹ã‚‰æœ€å¾Œã®ç•³ã¿è¾¼ã¿ã§ã‚ã‚‹Â <code>reduce()</code>Â ã‚’çœç•¥ã—ã¦ã¿ã¾ã™ã€‚</p>\n<pre class=\"part\" data-startline=\"79\" data-endline=\"87\"><code class=\"php hljs\">$collection = DusanKasan\\Knapsack\\Collection::range(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">100</span>);\n$collection\n    -&gt;map(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">($v)</span> </span>{ <span class=\"hljs-keyword\">return</span> pow($v, <span class=\"hljs-number\">2</span>); }) <span class=\"hljs-comment\">// å€¤ã‚’2ä¹—</span>\n    -&gt;filter(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">($v)</span> </span>{ <span class=\"hljs-keyword\">return</span> $v % <span class=\"hljs-number\">2</span> === <span class=\"hljs-number\">0</span>; }) <span class=\"hljs-comment\">// å¥‡æ•°ã‚’é™¤å¤–</span>\n    -&gt;map(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">($v)</span> </span>{ <span class=\"hljs-keyword\">return</span> dechex($v); }) <span class=\"hljs-comment\">// æ•°å€¤ã‚’16é€²æ•°ã«</span>\n    -&gt;map(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">(string $v)</span> </span>{ <span class=\"hljs-keyword\">return</span> strtoupper($v); }); <span class=\"hljs-comment\">// è‹±å­—ã‚’å¤§æ–‡å­—ã«</span>\n; \n</code></pre>\n<p class=\"part\" data-startline=\"89\" data-endline=\"89\">ã“ã®æ™‚ç‚¹ã§ã¯ã€3ã¤ã®Â <code>map()</code>Â ã¨ 1ã¤ã®Â <code>filter()</code>Â ã®è¨ˆç®—ã¯ã¾ã ã•ã‚Œã¾ã›ã‚“ã€‚ãã‚Œã©ã“ã‚ã‹ã€æœ€åˆã®Â <code>range()</code>Â ã«ã‚ˆã‚‹ç”Ÿæˆå‡¦ç†è‡ªä½“ã‚‚é…å»¶ã•ã‚Œã‚‹ã®ã§ã“ã®æ™‚ç‚¹ã§ã¯æœ¬å½“ã«ä½•ã‚‚å®Ÿè¡Œã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>\n<p class=\"part\" data-startline=\"91\" data-endline=\"92\">ç•³ã¿è¾¼ã¿ã§ã‚ã‚‹Â <code>reduce()</code>Â ã‚„ã€foreach ã«ã‚ˆã‚‹ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚ã‚‹ã„ã¯Â <code>toArray()</code>Â ã«ã‚ˆã‚‹é…åˆ—ã¸ã®å¤‰æ›ã‚’è¡Œã£ãŸæ™‚ã«ä¸€æ°—ã«å‡¦ç†ãŒè¡Œã‚ã‚Œã¾ã™ã€‚<br />\nã¤ã¾ã‚Šã€ä»¥ä¸‹ã®è¨˜è¿°ã¯å…¨ãä¸€ç·’ã§ã‚ã‚‹äº‹ã«ãªã‚Šã¾ã™:</p>\n<pre class=\"part\" data-startline=\"94\" data-endline=\"104\"><code class=\"php hljs\"><span class=\"hljs-keyword\">foreach</span> ($collection-&gt;map($funcA)-&gt;map($funcB)-&gt;filter($funcC)-&gt;map($funcD) <span class=\"hljs-keyword\">as</span> $v) {\n    <span class=\"hljs-keyword\">echo</span> $v;\n}\n\n<span class=\"hljs-keyword\">foreach</span> ($collection <span class=\"hljs-keyword\">as</span> $v) {\n    <span class=\"hljs-keyword\">if</span> ($funcC($tmp = $funcB($funcA($v)))) {\n        <span class=\"hljs-keyword\">echo</span> $funcD($tmp);\n    }\n}\n</code></pre>\n<h2 id=\"iterableã€ã¾ãŸã¯ã“ã‚Œã‚’è¿”ã™callableã¯å…¨ã¦å—ã‘å…¥ã‚Œå¯èƒ½\" class=\"part\" data-startline=\"106\" data-endline=\"106\">iterableã€ã¾ãŸã¯ã“ã‚Œã‚’è¿”ã™callableã¯å…¨ã¦å—ã‘å…¥ã‚Œå¯èƒ½</h2>\n<p class=\"part\" data-startline=\"108\" data-endline=\"110\">å®Ÿã¯ã€ã“ã‚ŒãŒåƒ•ãŒä¸€ç•ªKnapsackã®æ°—ã«å…¥ã£ã¦ã‚‹ç‚¹ã§ã™ã€‚<br />\nä¸€ç•ªæœ€åˆã«ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–æ–¹æ³•ã¨ã—ã¦ã€Collectionã‚¯ãƒ©ã‚¹ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¨Â <code>::from()</code>Â ã‚’æŒ™ã’ã¾ã—ãŸãŒã€ã“ã‚Œã‚‰ã«ã¯è¡¨é¡Œã®é€šã‚Šiterableã‹ã€iterableã‚’è¿”ã™callableãªã‚‰ä½•ã§ã‚‚æ¸¡ã™äº‹ãŒå¯èƒ½ã§ã™ã€‚<br />\nGeneratorã‚‚å½“ç„¶æ¸¡ã™äº‹ãŒå¯èƒ½ã§ã™ã—ã€å…ˆç¨‹ã®é…å»¶å‡¦ç†ã‚‚ç›¸ã¾ã£ã¦Doctrine ORMã®ã‚ˆã†ãªã€1ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ¡ãƒ¢ãƒªã‚³ã‚¹ãƒˆãŒéå¸¸ã«å¤§ãã„ç‰©ã‚’æ‰±ã†ã®ã«é©ã—ã¦ã„ã¾ã™ã€‚</p>\n<p class=\"part\" data-startline=\"112\" data-endline=\"112\">ä¾‹ãˆã°ã€ä»¥ä¸‹ã¯å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®IDã¨åå‰ã€ã¾ãŸãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚³ãƒ¡ãƒ³ãƒˆæ•°ã‚’é›†è¨ˆã—ãŸç‰©ã‚’CSVã®è¡Œã¨ã—ã¦è¡¨ã—ãŸç‰©ã‚’å–å¾—ã—ã¾ã™ã€‚</p>\n<pre class=\"part\" data-startline=\"114\" data-endline=\"164\"><code class=\"php hljs\"><span class=\"hljs-comment\">/** <span class=\"hljs-doctag\">@var</span> Acme\\User[] $users */</span>\n$users = DusanKasan\\Knapsack\\Collection::from(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">()</span> <span class=\"hljs-title\">use</span> <span class=\"hljs-params\">($em)</span> </span>{\n    $usersQuery = $em-&gt;createQuery(<span class=\"hljs-string\">'SELECT u FROM Acme\\User u'</span>);\n    \n    <span class=\"hljs-keyword\">foreach</span> ($usersQuery-&gt;iterate() <span class=\"hljs-keyword\">as</span> $counter =&gt; [$user]) { <span class=\"hljs-comment\">// æ¸¡ã£ã¦ãã‚‹å€¤ã¯arrayã§ãƒ©ãƒƒãƒ—ã•ã‚Œã¦ã„ã‚‹ã®ã§ã‚¢ãƒ³ãƒ©ãƒƒãƒ—ã™ã‚‹å¿…è¦ãŒã‚ã‚‹</span>\n        assert($user <span class=\"hljs-keyword\">instanceof</span> Acme\\User);\n    \n        <span class=\"hljs-keyword\">yield</span> $user;\n    \n        <span class=\"hljs-keyword\">if</span> (($counter + <span class=\"hljs-number\">1</span>) % <span class=\"hljs-number\">1000</span> === <span class=\"hljs-number\">0</span>) {\n            $em-&gt;clear(); <span class=\"hljs-comment\">// 1000å›ãƒˆãƒ©ãƒãƒ¼ã‚¹ã™ã‚‹æ¯ã«EntityManagerã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹æ”¾ã™ã‚‹</span>\n        }\n    }\n});\n\n<span class=\"hljs-comment\">// [ [1, \"Ariana Grande\", 10], [2, \"Taylor Swift\", 125], ...]</span>\n$csvRows = $users\n    <span class=\"hljs-comment\">// 1000ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¯ã®ãƒãƒ£ãƒ³ã‚¯ã«ã™ã‚‹ã€‚ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯ã¯æ¬¡ã®ã‚ˆã†ãªç‰©ã«ãªã‚‹</span>\n    <span class=\"hljs-comment\">// [ [$u1, $u2, ..., $u1000], [$u1001, $u1002, ..., ], ...]</span>\n    -&gt;partition(<span class=\"hljs-number\">1000</span>) \n    -&gt;map(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">(iterable $chunkedUsers)</span> </span>{\n        <span class=\"hljs-comment\">// 1000ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ†ã®idã®é…åˆ—ã‚’å¾—ã‚‹</span>\n        $userIds = DusanKasan\\Knapsack\\Collection::from($chunkedUsers)-&gt;map(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">($u)</span> </span>{ <span class=\"hljs-keyword\">return</span> $u-&gt;getId(); })-&gt;toArray();\n\n        <span class=\"hljs-comment\">// idã®é…åˆ—ã‹ã‚‰ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¯ã®ã‚³ãƒ¡ãƒ³ãƒˆæ•°ã‚’SQLã§é›†è¨ˆã—ã€idã®é…åˆ—é †ã§è¿”ã™ç‰©ã‚’æƒ³å®š</span>\n        $userNumComments = getUserNumCommentsFor($userIds);\n\n        <span class=\"hljs-comment\">// ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨å½“è©²ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ›¸ãè¾¼ã¿æ•°ã‚’zipã™ã‚‹ã€‚ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯æ¬¡ã®ã‚ˆã†ãªç‰©ã«ãªã‚‹</span>\n        <span class=\"hljs-comment\">// [ [$u1, $u1Comments], [$u2, $u2Comments], ..., [$u1000, $u1000Comments] ]</span>\n        <span class=\"hljs-keyword\">return</span> DusanKasan\\Knapsack\\Collection::from($chunkedUsers)\n            -&gt;zip($userNumComments);\n    })\n    <span class=\"hljs-comment\">// 1000ä»¶æ¯ã®ãƒãƒ£ãƒ³ã‚¯ã‚’å¹³å¦åŒ–ã™ã‚‹ã€‚ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯æ¬¡ã®ã‚ˆã†ã«å¤‰åŒ–ã™ã‚‹</span>\n    <span class=\"hljs-comment\">// before: [ [ [$u1, $u1Comments], [$u2, $u2Comments], ..., [$u1000, $u1000Comments] ], [ [$u1001, $u1001Comments, ...] ], ...]</span>\n    <span class=\"hljs-comment\">// after:  [ [$u1, $u1Comments], [$u2, $u2Comments], ..., [$uN, $uNComments]]</span>\n    -&gt;flatten(<span class=\"hljs-number\">1</span>)\n    -&gt;map(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">($zipped)</span> </span>{\n        <span class=\"hljs-comment\">// $zippedã¯ [$uN, $uComments] ã¨ãªã£ã¦ã„ã‚‹</span>\n    \n        $zippedCollection = \\DusanKasan\\Knapsack\\Collection::from($zipped);\n        $user = $zippedCollection-&gt;first();\n        $numComments = $zippedCollection-&gt;last();\n        assert($user <span class=\"hljs-keyword\">instanceof</span> Acme\\User);\n\n        <span class=\"hljs-keyword\">return</span> [$user-&gt;getId(), $user-&gt;getName(), $numComments];\n    })\n    -&gt;values()\n    -&gt;toArray()\n;\n</code></pre>\n<p class=\"part\" data-startline=\"166\" data-endline=\"166\">ä¸Šè¨˜ã§ã¯ã€å…¨ä½“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ãŒä½•äººã§ã‚ã‚Œä¸€åº¦ã«ãƒ¡ãƒ¢ãƒªã«ä¹—ã‚‹Userã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯æœ€å¤§ã§1000å€‹ã¾ã§ãªã®ã§ã€ãƒ¡ãƒ¢ãƒªã‚’ç¯€ç´„ã™ã‚‹äº‹ãŒå¯èƒ½ã¨ãªã£ã¦ã„ã¾ã™ã€‚</p>\n<h2 id=\"æ³¨æ„ç‚¹\" class=\"part\" data-startline=\"168\" data-endline=\"168\">æ³¨æ„ç‚¹</h2>\n<p class=\"part\" data-startline=\"170\" data-endline=\"172\">PHPã¯7ã‹ã‚‰é…åˆ—ãŒã‹ãªã‚Šé«˜é€ŸåŒ–ã•ã‚ŒãŸã®ã§ã€ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ã‚’ãµã‚“ã ã‚“ã«ä½¿ã†Knapsackã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯æ¨™æº–ã®é…åˆ—å‡¦ç†ã«æ¯”ã¹ã€ã‹ãªã‚Šãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®é¢ã§ã¯åŠ£ã‚Šã¾ã™ã€‚<br />\nWebã‚µãƒ¼ãƒãƒ¼ãŒHTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ä½œã‚‹ã®ã«æ‰±ã†ãƒ‡ãƒ¼ã‚¿é‡ãã‚‰ã„ã§ã‚ã‚Œã°æ°—ã«ãªã‚‰ãªã„ã§ã™ãŒã€ãƒãƒƒãƒã‚µãƒ¼ãƒãƒ¼ç­‰ã§å¤§è¦æ¨¡ãªãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã™ã‚‹éš›ã¯æ³¨æ„ãŒå¿…è¦ãªå ´é¢ãŒã‚ã‚Šã¾ã™ã€‚<br />\nã—ã‹ã—ã€é…åˆ—ã«è½ã¨ã—è¾¼ã‚€ã«ã¯ç›¸å¿œã®ãƒ¡ãƒ¢ãƒªãŒå¿…è¦ãªã®ã§ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã¨ãªã‚Šã¾ã™ã€‚</p>\n","dateObject":"2018-12-07T08:51:31.000Z","date":"December 07, 2018","categories":[{"name":"Uncategorized","slug":"uncategorized"}],"tags":[{"name":"Collection","slug":"collection"},{"name":"PHP","slug":"php"}],"author":{"name":"issei_m","slug":"issei"},"featured_media":{"media_details":{"sizes":{"large":{"source_url":"https://i2.wp.com/stg-engineering-wp.mobalab.net/wp-content/uploads/2018/12/cynthia-del-rio-88326-unsplash-e1544172634915.jpg?fit=1024%2C683&ssl=1","height":683,"width":1024},"medium_large":{"source_url":"https://i2.wp.com/stg-engineering-wp.mobalab.net/wp-content/uploads/2018/12/cynthia-del-rio-88326-unsplash-e1544172634915.jpg?fit=768%2C512&ssl=1","height":512,"width":768}}},"source_url":"https://stg-engineering-wp.mobalab.net/wp-content/uploads/2018/12/cynthia-del-rio-88326-unsplash-e1544172634915.jpg"},"wordpress_id":439}},"pageContext":{"id":"ee871b3f-1343-5d0a-af23-804053afba64","nextPath":"/2018/11/15/s3ã®getãƒªã‚¯ã‚¨ã‚¹ãƒˆã§rangeãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä½¿ã†/","nextTitle":"S3ã®GETãƒªã‚¯ã‚¨ã‚¹ãƒˆã§Rangeãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä½¿ã†","prevPath":"/2018/12/28/rspecã®letã®é…å»¶è©•ä¾¡ã‚’åˆ©ç”¨ã—ã¦ã‚ˆã‚Šã‚³ãƒ³ãƒ†ã‚¯ã‚¹ãƒãƒ¥ã‚¢/","prevTitle":"RSpecã®letã®é…å»¶è©•ä¾¡ã‚’åˆ©ç”¨ã—ã¦ã‚ˆã‚Šã‚³ãƒ³ãƒ†ã‚¯ã‚¹ãƒãƒ¥ã‚¢ãƒ«ãªSpecã‚’æ›¸ã"}}}